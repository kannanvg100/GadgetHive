{{> admin/navbar}}
<div class="container-fluid">
    <div class="row" style="min-height: 100vh;">
        <div class="d-flex">

            {{> admin/sidebar currTab = "dashboard"}}

            {{!-- Dashboard --}}

            <div class="flex-grow-1">
                <div class="mt-4 mx-3 pb-4">
                    <div>
                        <p class="fs-6 fw-bold">Dashboard</p>
                    </div>
                    <div class="d-flex gap-2">
                        <div class="mt-3 border rounded">
                            <div class="ps-4 py-2">
                                <span class="fw-semibold">Overall Sales</span>
                                <div id="total-sales" class="h4 fw-bold">{{formatPrice (sumOfPrices data)}}</div>
                            </div>
                            <div id="chartContainer" style="width:600px; height:300px;"></div>
                        </div>
                        <div class="mt-3 border rounded">
                            <div class="ps-4 py-2">
                                <span class="fw-semibold">Total items sold</span>
                                <div id="total-count" class="h4 fw-bold">{{sumOfCounts data}}</div>
                            </div>
                            <div id="chartContainer2" style="width:400px; height:300px;"></div>
                        </div>
                        <div>

                        </div>
                    </div>

                </div>
            </div>
        </div>
    </div>
</div>

{{> admin/footer}}

<script src="https://code.highcharts.com/highcharts.js"></script>

<script>
    // Sample data for total sales per month
    const data = {{{ json data }}}
    // Extracting the months and sales values from the data
    const date = data.map(item => {
        const date = new Date(item.date);
        return date.getDate();
    });
    const amount = data.map(item => item.amount);
    const count = data.map(item => item.count);

    let sum = 0
    for(const it in amount) sum+= it
    console.log("ðŸ“„ > file: dashboard.hbs:46 > sum:", sum)
    
    Highcharts.chart('chartContainer', {
        chart: {
            type: 'line'
        },
        title: {
            text: ''
        },
        xAxis: {
            categories: date
        },
        yAxis: {
            title: {
                text: 'Sales'
            }
        },
        legend: {
            enabled: false
        },
        series: [{
            name: 'Total Sales',
            data: amount,
        }]
    });

    Highcharts.chart('chartContainer2', {
        chart: {
            type: 'column'
        },
        title: {
            text: ''
        },
        xAxis: {
            categories: date
        },
        yAxis: {
            title: {
                text: 'Sales'
            }
        },
        legend: {
            enabled: false
        },
        series: [{
            name: 'Total Sales',
            data: count,
        }],
        plotOptions: {
            column: {
            pointWidth: 10,
            }
  },
    });
</script>